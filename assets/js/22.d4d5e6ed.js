(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{652:function(s,t){s.exports="data:image/png;base64,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"},653:function(s,t,a){s.exports=a.p+"assets/img/begin_login.a3e1b612.png"},758:function(s,t,a){"use strict";a.r(t);var n=a(7),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"_1-下载安装-go-cqhttp"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-下载安装-go-cqhttp"}},[s._v("#")]),s._v(" 1. 下载安装 go-cqhttp")]),s._v(" "),n("p",[s._v("根据官方文档说明，前往 "),n("a",{attrs:{href:"https://github.com/cqhttp/go-cqhttp",target:"_blank",rel:"noopener noreferrer"}},[s._v("release"),n("OutboundLink")],1),s._v(" 下载适合自己版本的 go-cqhttp，本文以"),n("code",[s._v("go-cqhttp_windows_amd64.exe")]),s._v("为例进行说明")]),s._v(" "),n("p",[s._v("第一次下载好"),n("code",[s._v("go-cqhttp.exe")]),s._v("后，双击运行，按照提示点击确定，等待生成"),n("code",[s._v("go-cqhttp.bat")]),s._v("后，双击运行bat，此时选择"),n("code",[s._v("0：HTTP通信")]),s._v("即可：")]),s._v(" "),n("p",[n("img",{attrs:{src:a(652),alt:"go-cqhttp-bat"}})]),s._v(" "),n("h1",{attrs:{id:"_2-配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-配置"}},[s._v("#")]),s._v(" 2. 配置")]),s._v(" "),n("p",[s._v("打开上一步生成的"),n("code",[s._v("config.yml")]),s._v("配置文件，初次使用，建议修改下面两项：")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("uin")]),s._v("：作为机器人的QQ账号")]),s._v(" "),n("li",[n("code",[s._v("password")]),s._v("：QQ密码，可填可不填（密码为空时使用扫码登录）")]),s._v(" "),n("li",[n("code",[s._v("address")]),s._v("和"),n("code",[s._v("url")]),s._v("：打开注释，若端口号没被占用，则无需修改")])]),s._v(" "),n("p",[s._v("我的配置如下：")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# go-cqhttp 默认配置文件")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("account")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 账号相关")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# QQ账号")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("password")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 密码为空时使用扫码登录")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("encrypt")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否开启密码加密")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("status")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在线状态 请参考 https://docs.go-cqhttp.org/guide/config.html#在线状态")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("relogin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重连设置")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("delay")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 首次重连延迟, 单位秒")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("interval")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重连间隔")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("max-times")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 最大重连次数, 0为无限制")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否使用服务器下发的新地址进行重连")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意, 此设置可能导致在海外服务器上连接情况更差")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("use-sso-address")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否允许发送临时会话消息")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("allow-temp-session")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("heartbeat")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 心跳频率, 单位秒")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -1 为关闭心跳")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("interval")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("-1")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("message")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上报数据类型")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可选: string,array")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("post-format")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" string\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否忽略无效的CQ码, 如果为假将原样发送")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ignore-invalid-cqcode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否强制分片发送消息")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分片发送将会带来更快的速度")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 但是兼容性会有些问题")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("force-fragment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否将url分片发送")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("fix-url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载图片等请求网络代理")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("proxy-rewrite")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否上报自身消息")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("report-self-message")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 移除服务端的Reply附带的At")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("remove-reply-at")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 为Reply附加更多信息")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("extra-reply-data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 跳过 Mime 扫描, 忽略错误数据")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("skip-mime-scan")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("output")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 日志等级 trace,debug,info,warn,error")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("log-level")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" warn\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 日志时效 单位天. 超过这个时间之前的日志将会被自动删除. 设置为 0 表示永久保留.")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("log-aging")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否在每次启动时强制创建全新的文件储存日志. 为 false 的情况下将会在上次启动时创建的日志文件续写")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("log-force-new")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否启用日志颜色")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("log-colorful")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否启用 DEBUG")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("debug")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开启调试模式")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认中间件锚点")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("default-middlewares")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("&default")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 访问密钥, 强烈推荐在公网的服务器设置")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("access-token")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 事件过滤器文件目录")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# API限速设置")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 该设置为全局生效")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 原 cqhttp 虽然启用了 rate_limit 后缀, 但是基本没插件适配")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 目前该限速设置为令牌桶算法, 请参考:")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# https://baike.baidu.com/item/%E4%BB%A4%E7%89%8C%E6%A1%B6%E7%AE%97%E6%B3%95/6597000?fr=aladdin")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("rate-limit")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("enabled")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否启用限速")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("frequency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 令牌回复频率, 单位秒")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("bucket")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 令牌桶大小")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("database")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据库相关设置")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("leveldb")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否启用内置leveldb数据库")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启用将会增加10-20MB的内存占用和一定的磁盘空间")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭将无法使用 撤回 回复 get_msg 等上下文相关功能")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("enable")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("sqlite3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否启用内置sqlite3数据库")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启用将会增加一定的内存占用和一定的磁盘空间")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭将无法使用 撤回 回复 get_msg 等上下文相关功能")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("enable")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cachettl")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3600000000000")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1h")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 连接服务列表")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("servers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加方式，同一连接方式可添加多个，具体配置说明请查看文档")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#- http: # http 通信")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#- ws:   # 正向 Websocket")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#- ws-reverse: # 反向 Websocket")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#- pprof: #性能分析服务器")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("http")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# HTTP 通信设置")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("address")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 0.0.0.0"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5700")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# HTTP监听地址")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("timeout")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 反向 HTTP 超时时间, 单位秒，<5 时将被忽略")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("long-polling")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 长轮询拓展")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("enabled")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("       "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否开启")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("max-queue-size")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 消息队列大小，0 表示不限制队列大小，谨慎使用")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("middlewares")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("*default")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 引用默认中间件")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("post")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("           "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 反向HTTP POST地址列表")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#- url: ''                # 地址")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  secret: ''             # 密钥")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  max-retries: 3         # 最大重试，0 时禁用")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  retries-interval: 1500 # 重试时间，单位毫秒，0 时立即")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//127.0.0.1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("5701/ "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 地址")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("secret")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("                  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 密钥")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  max-retries: 10             # 最大重试，0 时禁用")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  retries-interval: 1000      # 重试时间，单位毫秒，0 时立即")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br")])]),n("h1",{attrs:{id:"_3-登陆机器人"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-登陆机器人"}},[s._v("#")]),s._v(" 3. 登陆机器人")]),s._v(" "),n("p",[s._v("配置完成后，双击运行"),n("code",[s._v("go-cqhttp.bat")]),s._v("，根据提示进行操作，若看到上报器和服务器已启动，则表示运行没问题，出现"),n("code",[s._v("WARING警告")]),s._v("忽略即可")]),s._v(" "),n("p",[n("img",{attrs:{src:a(653),alt:"begin_login"}})]),s._v(" "),n("h1",{attrs:{id:"_4-消息格式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-消息格式"}},[s._v("#")]),s._v(" 4. 消息格式")]),s._v(" "),n("p",[s._v("详细格式参考"),n("a",{attrs:{href:"https://docs.go-cqhttp.org/event/#%E9%80%9A%E7%94%A8%E6%95%B0%E6%8D%AE",target:"_blank",rel:"noopener noreferrer"}},[n("strong",[s._v("官方文档")]),n("OutboundLink")],1)]),s._v(" "),n("p",[s._v("正常消息返回格式如下：")]),s._v(" "),n("div",{staticClass:"language-json line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t'post_type'"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 'message'"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t'message_type'"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 'private'"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t'time'"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1678779435")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t'self_id'"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456789")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t'sub_type'"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 'friend'"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t'message'"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" '消息'"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t'raw_message'"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" '消息'"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t'font'"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t'sender'"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t'age'"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t'nickname'"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 'xxx'"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t'sex'"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 'xxx'"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t'user_id'"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("987654321")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t'message_id'"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("-1361367431")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t'user_id'"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("987654321")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t'target_id'"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2077686705")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br")])]),n("h1",{attrs:{id:"_5-封装python脚本"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-封装python脚本"}},[s._v("#")]),s._v(" 5. 封装Python脚本")]),s._v(" "),n("h2",{attrs:{id:"_5-1-监听上报的消息"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-监听上报的消息"}},[s._v("#")]),s._v(" 5.1 监听上报的消息")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# receive.py")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" socket\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" json\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建一个socket对象，用于监听客户端的连接请求")]),s._v("\nserver "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" socket"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("socket"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("socket"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("AF_INET"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" socket"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SOCK_STREAM"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 绑定本地主机和5701端口号(cqhttp会上报信息到此端口，服务器监听此端口即可)")]),s._v("\nserver"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("bind"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'127.0.0.1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5701")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开始监听，最多允许10个连接请求排队等待")]),s._v("\nserver"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("listen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nHttpResponseHeader "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v("'''HTTP/1.1 200 OK\nContent-Type: text/html\\r\\n\\r\\n\n'''")]),s._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("data_to_json")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" i "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("range")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("len")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("and")]),s._v(" msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\\n"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" json"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("loads"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("None")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rev_msg")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# json or None")]),s._v("\n    client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" address "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" server"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("accept"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    data "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("recv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("decode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("encoding"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'utf-8'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    rev_json "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" data_to_json"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sendall"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("HttpResponseHeader"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("encode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("encoding"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'utf-8'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("close"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" rev_json\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br")])]),n("h2",{attrs:{id:"_5-2-发送消息"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-发送消息"}},[s._v("#")]),s._v(" 5.2 发送消息")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#send.py")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" socket\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" global_var "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" global_var\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" urllib"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("parse\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("_send_msg")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("resp_dict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    client "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" socket"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("socket"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("socket"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("AF_INET"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" socket"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SOCK_STREAM"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    ip "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'127.0.0.1'")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发送消息到此端口")]),s._v("\n    client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("connect"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5700")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    msg_type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" resp_dict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'msg_type'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 回复类型（群聊/私聊）")]),s._v("\n    number "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" resp_dict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'number'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 回复账号（群号/好友号）")]),s._v("\n    msg "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" resp_dict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'msg'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 要回复的消息")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将字符中的特殊字符进行url编码")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# msg = msg.replace(" ", "%20")')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# msg = msg.replace("\\n", "%0a")')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# msg = msg.encode("utf-8")')]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 字符串进行url编码")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'发送消息'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    msg "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" urllib"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("parse"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("quote"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" msg_type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'group'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        payload "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"GET /send_group_msg?group_id="')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("str")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n            number"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"&message="')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" msg "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('" HTTP/1.1\\r\\nHost:"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" ip "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('":5700\\r\\nConnection: close\\r\\n\\r\\n"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("elif")]),s._v(" msg_type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'private'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        payload "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"GET /send_private_msg?user_id="')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("str")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n            number"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"&message="')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" msg "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('" HTTP/1.1\\r\\nHost:"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" ip "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('":5700\\r\\nConnection: close\\r\\n\\r\\n"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# print("发送" + payload)')]),s._v("\n    client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("send"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("payload"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("encode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"utf-8"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("close"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("send_private_msg")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("qid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    resp_dict "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'msg_type'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'private'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'number'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" qid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'msg'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    _send_msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("resp_dict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("send_group_msg")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" gid"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("global_var"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get_value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'G_ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    resp_dict "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'msg_type'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'group'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'number'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" gid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'msg'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    _send_msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("resp_dict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br")])]),n("h2",{attrs:{id:"_5-3-脚本主逻辑"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-脚本主逻辑"}},[s._v("#")]),s._v(" 5.3 脚本主逻辑")]),s._v(" "),n("p",[s._v("主要逻辑是不断接收（receive）上报的消息，并进行处理，然后发送（send）给客户端，针对多个用户的消息消息，此处做了多线程优化，防止阻塞，部分关键代码如下")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# main.py")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" time\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" traceback\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" receive "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" rev_msg\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" handle "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" HandleMsg\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" threading\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建一个BoundedSemaphore对象，设置最大信号量为10（最多启动10个线程）")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("global")]),s._v(" maxLimiter\nmaxLimiter "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\nthreadLimiter "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" threading"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("BoundedSemaphore"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("maxLimiter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" os\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 禁用代理")]),s._v("\nos"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("environ"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'no_proxy'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("start_msg_handler")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\thandleMsg "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" HandleMsg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\thandleMsg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("reg_all_messages"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\trepeat_receive_msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("handleMsg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("repeat_receive_msg")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("handleMsg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" HandleMsg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t\t\trev "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" rev_msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rev"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" rev "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("None")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("continue")]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" rev"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"post_type"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" rev"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message_type"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"private"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 私聊")]),s._v("\n\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 另起线程去处理消息")]),s._v("\n\t\t\t\t\t\tthread "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" MessageHandlerThread"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("handleMsg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("handle_private_msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" rev"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t\t\t\t\tthread"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("start"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("elif")]),s._v(" rev"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message_type"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"group"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 群聊")]),s._v("\n\t\t\t\t\t\tthread "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" MessageHandlerThread"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("handleMsg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("handle_group_msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" rev"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t\t\t\t\tthread"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("start"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'其他消息'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("continue")]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("continue")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("except")]),s._v(" Exception "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t\t\ttraceback"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("print_exc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MessageHandlerThread")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("threading"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Thread"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("__init__")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" handle_func"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" rev_msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t\tthreading"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Thread"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("__init__"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\tself"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("handle_func "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" handle_func\n\t\tself"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rev_msg "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" rev_msg\n\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重写run方法，定义线程要执行的任务")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("run")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取一个信号量，如果已满则等待")]),s._v("\n\t\tthreadLimiter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("acquire"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t\t\tself"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("handle_func"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rev_msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("finally")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 释放一个信号量，让其他线程继续执行")]),s._v("\n\t\t\tthreadLimiter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("release"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" __name__ "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'__main__'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\tstart_msg_handler"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br")])]),n("h1",{attrs:{id:"_6-消息处理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-消息处理"}},[s._v("#")]),s._v(" 6. 消息处理")]),s._v(" "),n("p",[s._v("针对不同的消息，封装各种有意思的响应")]),s._v(" "),n("p",[n("strong",[s._v("To Be Continue...")])]),s._v(" "),n("WrapLine"),s._v(" "),n("h4",{attrs:{id:"个人博客-远近相安"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#个人博客-远近相安"}},[s._v("#")]),s._v(" 个人博客："),n("a",{attrs:{href:"https://lazerching.github.io/SamerBlog",target:"_blank",rel:"noopener noreferrer"}},[n("strong",[s._v("远近相安")]),n("OutboundLink")],1)])],1)}),[],!1,null,null,null);t.default=e.exports}}]);